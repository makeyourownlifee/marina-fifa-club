<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marina FIFA Club</title>
  <link rel="icon" href="https://i.imgur.com/nOKFXli.png" type="image/png">
  <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <link href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .glow:hover {
      box-shadow: 0 0 10px rgba(236, 72, 153, 0.5);
    }
    .page-bg {
      background-image: url('https://w0.peakpx.com/wallpaper/355/120/HD-wallpaper-champions-league-icio-uefa-champions-league.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
    }
    .close-btn {
      border: 2px solid white;
      border-radius: 50%;
      padding: 0 6px;
      line-height: 1;
    }
    @media (max-width: 640px) {
      .mb-mobile {
        margin-bottom: 4rem;
      }
      .modal-content {
        max-height: 80vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
    }
  </style>
</head>
<body class="bg-gray-900">
  <div id="root"></div>
  <script type="text/javascript">
    const { useState, useEffect } = React;

    const initialPlayers = [
      { id: 1, name: "Mell", avatar: null },
      { id: 2, name: "Bazsi", avatar: null },
      { id: 3, name: "Peti", avatar: null },
      { id: 4, name: "Lacus", avatar: null },
      { id: 5, name: "Benyó", avatar: null },
      { id: 6, name: "B-imi", avatar: null },
    ];

    const initialTeams = [
      "Arsenal", "Aston Villa", "Bournemouth", "Brentford", "Brighton & Hove Albion",
      "Chelsea", "Crystal Palace", "Everton", "Fulham", "Ipswich Town",
      "Leicester City", "Liverpool", "Manchester City", "Manchester United",
      "Newcastle United", "Nottingham Forest", "Southampton", "Tottenham Hotspur",
      "West Ham United", "Wolverhampton Wanderers",
      "Alavés", "Athletic Club", "Atlético Madrid", "Barcelona", "Celta Vigo",
      "Deportivo Alavés", "Getafe", "Girona", "Las Palmas", "Leganés",
      "Mallorca", "Osasuna", "Rayo Vallecano", "Real Betis", "Real Madrid",
      "Real Sociedad", "Sevilla", "Valencia", "Valladolid", "Villarreal",
      "Augsburg", "Bayern Munich", "Borussia Dortmund", "Borussia Mönchengladbach",
      "Eintracht Frankfurt", "Freiburg", "Bayer Leverkusen", "Heidenheim", "Hoffenheim",
      "Holstein Kiel", "Mainz", "RB Leipzig", "St. Pauli", "Stuttgart",
      "Union Berlin", "Werder Bremen", "Wolfsburg", "Bochum", "Köln",
      "Angers", "Auxerre", "Brest", "Le Havre", "Lens",
      "Lille", "Lyon", "Marseille", "Monaco", "Montpellier",
      "Nantes", "Nice", "Paris Saint-Germain", "Reims", "Rennes",
      "Saint-Étienne", "Strasbourg", "Toulouse",
      "AC Milan", "Atalanta", "Bologna", "Cagliari", "Como",
      "Empoli", "Fiorentina", "Genoa", "Hellas Verona", "Inter Milan",
      "Juventus", "Lazio", "Lecce", "Monza", "Napoli",
      "Parma", "Roma", "Sampdoria", "Torino", "Udinese",
      "Argentina", "France", "Spain", "England", "Brazil",
      "Belgium", "Portugal", "Netherlands", "Italy", "Croatia",
      "Colombia", "Uruguay", "Germany", "Mexico", "USA",
      "Switzerland", "Morocco", "Japan", "Senegal", "Denmark",
      "Iran", "South Korea", "Poland", "Algeria", "Serbia",
      "Chile", "Nigeria", "Austria", "Ukraine", "Egypt",
      "Peru", "Sweden", "Czech Republic", "Norway", "Ghana",
      "Turkey", "Cameroon", "Greece", "Wales", "Tunisia",
      "Ivory Coast", "Hungary", "Scotland", "Romania", "Venezuela",
      "Paraguay", "Finland", "Slovakia", "Iraq"
    ].filter((team, index, self) => self.indexOf(team) === index);

    const shuffleArray = (array) => {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    };

    const generateTournament = (players) => {
      const matches = [];
      const shuffledPlayers = shuffleArray([...players]);
      const numPlayers = players.length;

      if (numPlayers === 5) {
        const pairs = [
          [[0, 1], [2, 3]],
          [[0, 2], [1, 4]],
          [[0, 3], [1, 4]],
          [[0, 4], [2, 3]],
          [[1, 3], [2, 4]],
        ];
        pairs.forEach(([team1, team2], index) => {
          matches.push({
            id: `match-5p-${index}-${Date.now()}`,
            team1: [shuffledPlayers[team1[0]], shuffledPlayers[team1[1]]],
            team2: [shuffledPlayers[team2[0]], shuffledPlayers[team2[1]]],
            goals: { team1: "", team2: "" },
            team1Club: "",
            team2Club: "",
            resting: shuffledPlayers[4 - index % 5],
            confirmed: false,
          });
        });
      } else if (numPlayers === 4) {
        const pairs = [
          [[0, 1], [2, 3]],
          [[2, 3], [0, 1]],
          [[0, 2], [1, 3]],
          [[1, 3], [0, 2]],
          [[0, 3], [1, 2]],
          [[1, 2], [0, 3]],
        ];
        pairs.forEach(([team1, team2], index) => {
          matches.push({
            id: `match-4p-${index}-${Date.now()}`,
            team1: [shuffledPlayers[team1[0]], shuffledPlayers[team1[1]]],
            team2: [shuffledPlayers[team2[0]], shuffledPlayers[team2[1]]],
            goals: { team1: "", team2: "" },
            team1Club: "",
            team2Club: "",
            resting: null,
            confirmed: false,
          });
        });
      }
      return matches;
    };

    const calculateTopTeams = (tournaments) => {
      const teamStats = {};
      tournaments.forEach(tournament => {
        tournament.matches.forEach(match => {
          if (match.team1Club && match.goals.team1 !== "" && match.goals.team2 !== "") {
            if (!teamStats[match.team1Club]) {
              teamStats[match.team1Club] = { matches: 0, wins: 0, goals: 0 };
            }
            teamStats[match.team1Club].matches += 1;
            teamStats[match.team1Club].goals += parseInt(match.goals.team1) || 0;
            if (parseInt(match.goals.team1) > parseInt(match.goals.team2)) {
              teamStats[match.team1Club].wins += 1;
            }
          }
          if (match.team2Club && match.goals.team1 !== "" && match.goals.team2 !== "") {
            if (!teamStats[match.team2Club]) {
              teamStats[match.team2Club] = { matches: 0, wins: 0, goals: 0 };
            }
            teamStats[match.team2Club].matches += 1;
            teamStats[match.team2Club].goals += parseInt(match.goals.team2) || 0;
            if (parseInt(match.goals.team2) > parseInt(match.goals.team1)) {
              teamStats[match.team2Club].wins += 1;
            }
          }
        });
      });

      const topTeams = Object.keys(teamStats)
        .map(team => ({
          name: team,
          matches: teamStats[team].matches,
          wins: teamStats[team].wins,
          winRate: (teamStats[team].wins / teamStats[team].matches) * 100,
          xG: teamStats[team].goals / teamStats[team].matches,
        }))
        .filter(team => teamStats[team.name].matches >= 1)
        .sort((a, b) => b.winRate - a.winRate)
        .slice(0, 10);

      return topTeams;
    };

    const calculatePlayerStats = (matches) => {
      const stats = {};
      matches.forEach(match => {
        const team1Players = match.team1.map(p => p.id);
        const team2Players = match.team2.map(p => p.id);
        const goals1 = parseInt(match.goals.team1) || 0;
        const goals2 = parseInt(match.goals.team2) || 0;

        team1Players.forEach(playerId => {
          if (!stats[playerId]) {
            stats[playerId] = { wins: 0, goalsScored: 0, goalsConceded: 0 };
          }
          stats[playerId].goalsScored += goals1;
          stats[playerId].goalsConceded += goals2;
          if (goals1 > goals2) {
            stats[playerId].wins += 1;
          }
        });

        team2Players.forEach(playerId => {
          if (!stats[playerId]) {
            stats[playerId] = { wins: 0, goalsScored: 0, goalsConceded: 0 };
          }
          stats[playerId].goalsScored += goals2;
          stats[playerId].goalsConceded += goals1;
          if (goals2 > goals1) {
            stats[playerId].wins += 1;
          }
        });
      });

      return Object.keys(stats)
        .map(playerId => ({
          player: initialPlayers.find(p => p.id === parseInt(playerId)),
          wins: stats[playerId].wins,
          goalsScored: stats[playerId].goalsScored,
          goalsConceded: stats[playerId].goalsConceded,
          goalDifference: stats[playerId].goalsScored - stats[playerId].goalsConceded,
        }))
        .sort((a, b) => {
          if (b.wins !== a.wins) return b.wins - a.wins;
          return b.goalDifference - a.goalDifference;
        });
    };

    const calculatePairStats = (tournaments, pair) => {
      let matches = 0, wins = 0, goalsScored = 0, goalsConceded = 0;
      tournaments.forEach(tournament => {
        tournament.matches.forEach(match => {
          const team1Ids = match.team1.map(p => p.id).sort().join(",");
          const team2Ids = match.team2.map(p => p.id).sort().join(",");
          const pairIds = pair.map(p => p.id).sort().join(",");
          if (team1Ids === pairIds || team2Ids === pairIds) {
            matches++;
            const isTeam1 = team1Ids === pairIds;
            const teamGoals = parseInt(isTeam1 ? match.goals.team1 : match.goals.team2) || 0;
            const opponentGoals = parseInt(isTeam1 ? match.goals.team2 : match.goals.team1) || 0;
            goalsScored += teamGoals;
            goalsConceded += opponentGoals;
            if (teamGoals > opponentGoals) wins++;
          }
        });
      });

      return {
        matches,
        winRate: matches > 0 ? (wins / matches) * 100 : 0,
        avgGoalsScored: matches > 0 ? goalsScored / matches : 0,
        avgGoalsConceded: matches > 0 ? goalsConceded / matches : 0,
      };
    };

    const calculateHeadToHeadStats = (tournaments, pair1, pair2) => {
      let matches = 0, wins = 0, goalsScored = 0, goalsConceded = 0;
      tournaments.forEach(tournament => {
        tournament.matches.forEach(match => {
          const team1Ids = match.team1.map(p => p.id).sort().join(",");
          const team2Ids = match.team2.map(p => p.id).sort().join(",");
          const pair1Ids = pair1.map(p => p.id).sort().join(",");
          const pair2Ids = pair2.map(p => p.id).sort().join(",");
          if ((team1Ids === pair1Ids && team2Ids === pair2Ids) || (team1Ids === pair2Ids && team2Ids === pair1Ids)) {
            matches++;
            const isTeam1 = team1Ids === pair1Ids;
            const teamGoals = parseInt(isTeam1 ? match.goals.team1 : match.goals.team2) || 0;
            const opponentGoals = parseInt(isTeam1 ? match.goals.team2 : match.goals.team1) || 0;
            goalsScored += teamGoals;
            goalsConceded += opponentGoals;
            if (teamGoals > opponentGoals) wins++;
          }
        });
      });

      return {
        matches,
        winRate: matches > 0 ? (wins / matches) * 100 : 0,
        avgGoalsScored: matches > 0 ? goalsScored / matches : 0,
        avgGoalsConceded: matches > 0 ? goalsConceded / matches : 0,
      };
    };

    const NavBar = ({ setCurrentPage, currentPage }) => {
      const handleNavClick = (page) => {
        try {
          console.log("Nav clicked, setting page to:", page);
          setCurrentPage(page);
          window.location.hash = page;
        } catch (error) {
          console.error("Error in handleNavClick:", error);
        }
      };

      return React.createElement(
        "nav",
        { className: "fixed bottom-0 w-full bg-gray-800 bg-opacity-90 text-white flex justify-around py-4 shadow-lg" },
        [
          React.createElement(
            "a",
            {
              key: "nav-home",
              href: "#home",
              onClick: () => handleNavClick("home"),
              className: `flex items-center transition-all ${currentPage === "home" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "home" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001 1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-players",
              href: "#players",
              onClick: () => handleNavClick("players"),
              className: `flex items-center transition-all ${currentPage === "players" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "players" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-generate",
              href: "#generate",
              onClick: () => handleNavClick("generate"),
              className: `flex items-center transition-all ${currentPage === "generate" ? "border-b-2 border-pink-500 text-pink-500 shadow-[0_0_5px_rgba(236,72,153,0.5)]" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "generate" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 24 24" },
              React.createElement("path", { d: "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-dicegame",
              href: "#dicegame",
              onClick: () => handleNavClick("dicegame"),
              className: `flex items-center transition-all ${currentPage === "dicegame" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "dicegame" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M3 3h14v14H3V3zm2 2v10h10V5H5zm2 2h2v2H7V7zm0 4h2v2H7v-2zm4-4h2v2h-2V7zm0 4h2v2h-2v-2zm4-4h2v2h-2V7z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-stats",
              href: "#stats",
              onClick: () => handleNavClick("stats"),
              className: `flex items-center transition-all ${currentPage === "stats" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "stats" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M2 3h16v2H2V3zm0 4h4v10H2V7zm6 0h4v10H8V7zm6 0h4v10h-4V7z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-rounds",
              href: "#rounds",
              onClick: () => handleNavClick("rounds"),
              className: `flex items-center transition-all ${currentPage === "rounds" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "rounds" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" })
            )
          ),
        ]
      );
    };

    const Home = ({ tournaments }) => {
      const topTeams = calculateTopTeams(tournaments);

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        React.createElement(
          "div",
          { className: "bg-gray-900 bg-opacity-75 p-6 rounded-2xl" },
          [
            React.createElement("img", {
              src: "https://i.imgur.com/nOKFXli.png",
              alt: "Marina FIFA Club Logo",
              className: "w-48 h-48 mx-auto mt-4 sm:w-40 sm:h-40 fade-in",
              style: { objectFit: "contain" }
            }),
            React.createElement("h1", { className: "text-4xl font-bold text-white text-center mt-4" }, "Marina FIFA Club"),
            React.createElement("p", { className: "text-center mt-6 text-gray-400 text-lg font-light" }, "Üdv a bajnokság appban! Generálj egy új bajnokságot, vagy játssz egy kockajátékot!"),
            React.createElement(
              "div",
              { className: "mt-8" },
              [
                React.createElement("h2", { className: "text-2xl font-bold text-white" }, "TOP FIFA Csapatok"),
                topTeams.length > 0 ? React.createElement(
                  "div",
                  { className: "mt-4 grid grid-cols-4 gap-2 text-gray-400 text-sm" },
                  [
                    React.createElement("span", { className: "font-bold" }, "Csapat"),
                    React.createElement("span", { className: "font-bold text-center" }, "Meccsek"),
                    React.createElement("span", { className: "font-bold text-center" }, "Győzelmi arány"),
                    React.createElement("span", { className: "font-bold text-center" }, "xG"),
                    ...topTeams.flatMap((team, index) => [
                      React.createElement("span", { key: `team-${index}-name`, className: "text-white" }, team.name),
                      React.createElement("span", { key: `team-${index}-matches`, className: "text-center" }, team.matches),
                      React.createElement("span", { key: `team-${index}-winrate`, className: "text-center" }, 
                        `${team.wins} (${team.winRate.toFixed(1)}%)`
                      ),
                      React.createElement("span", { key: `team-${index}-xg`, className: "text-center" }, team.xG.toFixed(2)),
                    ]),
                  ]
                ) : React.createElement("p", { className: "mt-4 text-gray-400" }, "Még nincs elég adat a statisztikához. Játssz néhány meccset!")
              ]
            ),
          ]
        )
      );
    };

    const Players = ({ players, setPlayers, addPlayer, teams, addCustomTeam }) => {
      const [newPlayerName, setNewPlayerName] = useState("");
      const [customTeam, setCustomTeam] = useState("");
      const [editPlayer, setEditPlayer] = useState(null);
      const [editName, setEditName] = useState("");
      const [editAvatar, setEditAvatar] = useState("");

      const handleAddPlayer = () => {
        if (newPlayerName.trim()) {
          addPlayer({
            id: players.length + 1,
            name: newPlayerName,
            avatar: null,
          });
          setNewPlayerName("");
        }
      };

      const handleAddCustomTeam = () => {
        if (customTeam.trim() && !teams.includes(customTeam.trim())) {
          addCustomTeam(customTeam.trim());
          setCustomTeam("");
        }
      };

      const handleEditPlayer = (player) => {
        setEditPlayer(player);
        setEditName(player.name);
        setEditAvatar(player.avatar || "");
      };

      const handleSaveEdit = () => {
        if (editName.trim()) {
          setPlayers(players.map(p =>
            p.id === editPlayer.id ? { ...p, name: editName, avatar: editAvatar || null } : p
          ));
          setEditPlayer(null);
          setEditName("");
          setEditAvatar("");
        }
      };

      const handleCloseEdit = () => {
        setEditPlayer(null);
        setEditName("");
        setEditAvatar("");
      };

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-75 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Játékosok"),
              React.createElement(
                "div",
                { className: "grid grid-cols-1 gap-4 mt-6" },
                players.map(player =>
                  React.createElement(
                    "div",
                    {
                      key: `player-${player.id}`,
                      className: "flex items-center bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all cursor-pointer",
                      onClick: () => handleEditPlayer(player)
                    },
                    [
                      player.avatar ? 
                        React.createElement("img", {
                          src: player.avatar,
                          alt: `${player.name} avatar`,
                          className: "w-12 h-12 rounded-full mr-4 object-cover"
                        }) :
                        React.createElement(
                          "div",
                          { className: "w-12 h-12 rounded-full bg-pink-500 flex items-center justify-center mr-4 text-white text-lg font-bold" },
                          player.name.charAt(0).toUpperCase()
                        ),
                      React.createElement("span", { className: "text-white font-medium text-lg" }, player.name),
                    ]
                  )
                )
              ),
              React.createElement(
                "div",
                { className: "mt-6" },
                [
                  React.createElement("input", {
                    type: "text",
                    value: newPlayerName,
                    onChange: (e) => setNewPlayerName(e.target.value),
                    placeholder: "Új játékos neve",
                    className: "border border-gray-600 bg-gray-800 text-white p-3 rounded-2xl w-full focus:outline-none focus:ring-2 focus:ring-pink-500",
                  }),
                  React.createElement(
                    "button",
                    {
                      onClick: handleAddPlayer,
                      className: "mt-4 bg-gray-200 text-gray-800 p-3 rounded-2xl w-full hover:bg-gray-100 active:scale-95 transition-all glow"
                    },
                    "Játékos hozzáadása"
                  ),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-6" },
                [
                  React.createElement("h3", { className: "text-xl font-bold text-white" }, "Egyedi csapat hozzáadása"),
                  React.createElement("input", {
                    type: "text",
                    value: customTeam,
                    onChange: (e) => setCustomTeam(e.target.value),
                    placeholder: "Egyedi csapat neve (pl. Adiddas XI)",
                    className: "border border-gray-600 bg-gray-800 text-white p-3 rounded-2xl w-full focus:outline-none focus:ring-2 focus:ring-pink-500",
                  }),
                  React.createElement(
                    "button",
                    {
                      onClick: handleAddCustomTeam,
                      disabled: !customTeam.trim(),
                      className: "mt-4 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600"
                    },
                    "Egyedi csapat mentése"
                  ),
                ]
              ),
            ]
          ),
          editPlayer && React.createElement(
            "div",
            { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4" },
            React.createElement(
              "div",
              { className: "bg-gray-900 p-6 rounded-2xl w-full max-w-lg modal-content" },
              [
                React.createElement(
                  "button",
                  {
                    onClick: handleCloseEdit,
                    className: "absolute top-2 right-2 text-white text-2xl close-btn"
                  },
                  "✕"
                ),
                React.createElement("h3", { className: "text-2xl font-bold text-white" }, "Játékos szerkesztése"),
                React.createElement(
                  "div",
                  { className: "mt-4 space-y-4" },
                  [
                    React.createElement("input", {
                      type: "text",
                      value: editName,
                      onChange: (e) => setEditName(e.target.value),
                      placeholder: "Játékos neve",
                      className: "border border-gray-600 bg-gray-800 text-white p-3 rounded-2xl w-full focus:outline-none focus:ring-2 focus:ring-pink-500",
                    }),
                    React.createElement("input", {
                      type: "text",
                      value: editAvatar,
                      onChange: (e) => setEditAvatar(e.target.value),
                      placeholder: "Avatar URL (pl. https://i.imgur.com/xyz.png)",
                      className: "border border-gray-600 bg-gray-800 text-white p-3 rounded-2xl w-full focus:outline-none focus:ring-2 focus:ring-pink-500",
                    }),
                    editAvatar && React.createElement("img", {
                      src: editAvatar,
                      alt: "Avatar előnézet",
                      className: "w-24 h-24 rounded-full mx-auto mt-4 object-cover"
                    }),
                    React.createElement(
                      "button",
                      {
                        onClick: handleSaveEdit,
                        className: "bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow"
                      },
                      "Mentés"
                    ),
                  ]
                ),
              ]
            )
          ),
        ]
      );
    };

    const DiceGame = ({ players, addDiceGame }) => {
      const [selectedPlayers, setSelectedPlayers] = useState([]);
      const [isTie, setIsTie] = useState(false);

      const handlePlayerSelect = (playerId) => {
        if (selectedPlayers.includes(playerId)) {
          setSelectedPlayers(selectedPlayers.filter(id => id !== playerId));
        } else {
          setSelectedPlayers([...selectedPlayers, playerId]);
        }
      };

      const handleCloseGame = () => {
        if (selectedPlayers.length >= 2) {
          const results = selectedPlayers.map((playerId, index) => {
            let position = getPlayerPosition(playerId);
            return { playerId, position };
          });
          addDiceGame({ timestamp: new Date().toISOString(), results });
          setSelectedPlayers([]);
          setIsTie(false);
        }
      };

      const getPlayerPosition = (playerId) => {
        const index = selectedPlayers.indexOf(playerId);
        if (index === -1) return null;
        if (isTie && index < 2) return 1;
        return index + 1;
      };

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-75 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Kockajáték"),
              React.createElement(
                "button",
                {
                  onClick: () => setIsTie(!isTie),
                  className: `mt-6 px-4 py-2 rounded-2xl ${isTie ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                },
                "DÖNTETLEN"
              ),
              React.createElement(
                "div",
                { className: "mt-6 grid grid-cols-2 gap-2" },
                players.map(player =>
                  React.createElement(
                    "button",
                    {
                      key: `player-select-${player.id}`,
                      onClick: () => handlePlayerSelect(player.id),
                      className: `px-4 py-2 rounded-2xl text-white flex items-center justify-between ${selectedPlayers.includes(player.id) ? "bg-pink-500" : "bg-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    [
                      React.createElement("span", { key: `player-name-${player.id}` }, player.name),
                      selectedPlayers.includes(player.id) && React.createElement(
                        "span",
                        { key: `player-position-${player.id}`, className: "text-white font-bold" },
                        getPlayerPosition(player.id)
                      ),
                    ]
                  )
                )
              ),
              React.createElement(
                "button",
                {
                  onClick: handleCloseGame,
                  disabled: selectedPlayers.length < 2,
                  className: "mt-8 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600"
                },
                "LEZÁRÁS"
              ),
            ]
          ),
        ]
      );
    };

    const GenerateTournament = ({ players, addTournament, teams, tournaments }) => {
      const [mode, setMode] = useState(5);
      const [selectedPlayers, setSelectedPlayers] = useState([]);
      const [matches, setMatches] = useState(JSON.parse(localStorage.getItem('tournament-draft')) || []);
      const [teamSearch, setTeamSearch] = useState({});
      const [showSuggestions, setShowSuggestions] = useState({});

      useEffect(() => {
        localStorage.setItem('tournament-draft', JSON.stringify(matches));
      }, [matches]);

      const handlePlayerToggle = (playerId) => {
        if (selectedPlayers.includes(playerId)) {
          setSelectedPlayers(selectedPlayers.filter(id => id !== playerId));
        } else if (selectedPlayers.length < mode) {
          setSelectedPlayers([...selectedPlayers, playerId]);
        }
      };

      const handleGenerate = () => {
        if (selectedPlayers.length === mode) {
          const tournamentPlayers = players.filter(p => selectedPlayers.includes(p.id));
          const generatedMatches = generateTournament(tournamentPlayers);
          setMatches(generatedMatches);
        }
      };

      const handleConfirmMatch = (matchId) => {
        setMatches(matches.map(match =>
          match.id === matchId && match.goals.team1 !== "" && match.goals.team2 !== ""
            ? { ...match, confirmed: !match.confirmed }
            : match
        ));
      };

      const handleSaveDraft = () => {
        alert('Vázlat mentve!');
      };

      const handleCloseTournament = () => {
        if (matches.length > 0) {
          addTournament({ matches, timestamp: new Date().toISOString() });
          setMatches([]);
          setSelectedPlayers([]);
          localStorage.removeItem('tournament-draft');
        }
      };

      const handleTeamSearch = (matchId, team, value) => {
        setTeamSearch({ ...teamSearch, [`${matchId}-${team}`]: value });
        setShowSuggestions({ ...showSuggestions, [`${matchId}-${team}`]: value !== "" });
        if (value === "") {
          setMatches(matches.map(match =>
            match.id === matchId ? { ...match, [team]: "" } : match
          ));
        }
      };

      const selectTeam = (matchId, team, selectedTeam) => {
        setMatches(matches.map(match =>
          match.id === matchId
            ? { ...match, [team]: selectedTeam }
            : match
        ));
        setTeamSearch({ ...teamSearch, [`${matchId}-${team}`]: selectedTeam });
        setShowSuggestions({ ...showSuggestions, [`${matchId}-${team}`]: false });
      };

      const canGenerate = matches.length === 0 || !matches.some(match => match.goals.team1 !== "" || match.goals.team2 !== "");

      const playerStats = calculatePlayerStats(matches);

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-75 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Bajnokság Generálás"),
              React.createElement(
                "div",
                { className: "flex gap-4 mt-6" },
                [
                  React.createElement(
                    "button",
                    {
                      onClick: () => setMode(5),
                      className: `px-4 py-2 rounded-2xl ${mode === 5 ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "5-játékos"
                  ),
                  React.createElement(
                    "button",
                    {
                      onClick: () => setMode(4),
                      className: `px-4 py-2 rounded-2xl ${mode === 4 ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "4-játékos"
                  ),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-6 grid grid-cols-2 gap-2" },
                players.map(player =>
                  React.createElement(
                    "button",
                    {
                      key: `player-select-${player.id}`,
                      onClick: () => handlePlayerToggle(player.id),
                      disabled: !selectedPlayers.includes(player.id) && selectedPlayers.length >= mode,
                      className: `px-4 py-2 rounded-2xl text-white ${selectedPlayers.includes(player.id) ? "bg-pink-500" : "bg-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600`
                    },
                    player.name
                  )
                )
              ),
              React.createElement(
                "button",
                {
                  onClick: handleGenerate,
                  disabled: selectedPlayers.length !== mode || !canGenerate,
                  className: "mt-6 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600"
                },
                "KEZDÉS"
              ),
              matches.length > 0 && React.createElement(
                "button",
                {
                  onClick: handleSaveDraft,
                  className: "mt-4 bg-gray-200 text-gray-800 p-3 rounded-2xl w-full hover:bg-gray-100 active:scale-95 transition-all glow"
                },
                "Mentés vázlatként"
              ),
              matches.length > 0 && React.createElement(
                "div",
                { className: "mt-8 bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500" },
                [
                  React.createElement("h4", { className: "text-2xl font-bold text-white text-center" }, "🏆"),
                  React.createElement(
                    "div",
                    { className: "grid grid-cols-5 gap-2 text-gray-400 text-sm mt-2" },
                    [
                      React.createElement("span", { className: "font-bold" }, ""),
                      React.createElement("span", { className: "font-bold" }, ""),
                      React.createElement("span", { className: "font-bold text-center" }, "W"),
                      React.createElement("span", { className: "font-bold text-center" }, "LG"),
                      React.createElement("span", { className: "font-bold text-center" }, "KG"),
                      ...playerStats.map((stat, index) => [
                        React.createElement("span", { key: `stat-${index}-pos`, className: "text-pink-500 font-bold" }, `${index + 1}.`),
                        React.createElement("span", { key: `stat-${index}-name` }, stat.player ? stat.player.name : "Ismeretlen"),
                        React.createElement("span", { key: `stat-${index}-wins`, className: "text-center text-pink-500 font-bold" }, stat.wins),
                        React.createElement("span", { key: `stat-${index}-gs`, className: "text-center" }, stat.goalsScored),
                        React.createElement("span", { key: `stat-${index}-gc`, className: "text-center" }, stat.goalsConceded),
                      ]),
                    ]
                  ),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-8 flex overflow-x-auto space-x-6 pb-4" },
                matches.map((match, index) => {
                  const pair1Stats = calculatePairStats(tournaments, match.team1);
                  const pair2Stats = calculatePairStats(tournaments, match.team2);
                  const headToHeadStats = calculateHeadToHeadStats(tournaments, match.team1, match.team2);

                  return React.createElement(
                    "div",
                    { key: match.id, className: "flex-shrink-0 w-full max-w-3xl bg-gray-800 bg-opacity-80 p-6 rounded-2xl border border-pink-500 glow transition-all" },
                    [
                      React.createElement("h3", { className: "text-gray-400 text-sm text-center font-medium" }, `#${index + 1}`),
                      React.createElement(
                        "div",
                        { className: "flex flex-row justify-between items-center mt-4 space-x-4" },
                        [
                          React.createElement(
                            "div",
                            { className: "flex-1 min-w-0 max-w-[150px] flex flex-col items-start" },
                            [
                              React.createElement(
                                "span",
                                { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                `${match.team1[0].name} + ${match.team1[1].name}`
                              ),
                              React.createElement(
                                "div",
                                { className: "relative w-full mt-2" },
                                [
                                  React.createElement("input", {
                                    type: "text",
                                    value: teamSearch[`${match.id}-team1Club`] || match.team1Club || "",
                                    onChange: (e) => handleTeamSearch(match.id, "team1Club", e.target.value),
                                    placeholder: "Csapat keresése...",
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"
                                  }),
                                  showSuggestions[`${match.id}-team1Club`] && React.createElement(
                                    "div",
                                    { className: "absolute z-10 bg-gray-800 border border-gray-600 rounded-2xl mt-1 w-full max-h-40 overflow-y-auto" },
                                    teams
                                      .filter(team => team.toLowerCase().includes((teamSearch[`${match.id}-team1Club`] || "").toLowerCase()))
                                      .slice(0, 5)
                                      .map(team =>
                                        React.createElement(
                                          "div",
                                          {
                                            key: `${match.id}-team1-club-${team}`,
                                            onClick: () => selectTeam(match.id, "team1Club", team),
                                            className: "p-2 text-white text-sm hover:bg-pink-500 cursor-pointer"
                                          },
                                          team
                                        )
                                      )
                                  ),
                                ]
                              ),
                            ]
                          ),
                          React.createElement(
                            "div",
                            { className: "flex flex-col items-center" },
                            [
                              React.createElement(
                                "div",
                                { className: "flex justify-center items-center" },
                                [
                                  React.createElement("input", {
                                    type: "number",
                                    inputMode: "numeric",
                                    value: match.goals.team1,
                                    onChange: (e) => {
                                      match.goals.team1 = e.target.value;
                                      setMatches([...matches]);
                                    },
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-20 h-12 text-4xl text-center"
                                  }),
                                  React.createElement("div", { className: "text-gray-400 font-bold mx-2 text-lg" }, "vs"),
                                  React.createElement("input", {
                                    type: "number",
                                    inputMode: "numeric",
                                    value: match.goals.team2,
                                    onChange: (e) => {
                                      match.goals.team2 = e.target.value;
                                      setMatches([...matches]);
                                    },
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-20 h-12 text-4xl text-center"
                                  }),
                                ]
                              ),
                              React.createElement(
                                "span",
                                {
                                  onClick: () => handleConfirmMatch(match.id),
                                  className: `mt-2 text-lg cursor-pointer ${match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "text-green-500" : "text-gray-500"}`
                                },
                                match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "✅" : "☑️"
                              ),
                            ]
                          ),
                          React.createElement(
                            "div",
                            { className: "flex-1 min-w-0 max-w-[150px] flex flex-col items-end" },
                            [
                              React.createElement(
                                "span",
                                { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                `${match.team2[0].name} + ${match.team2[1].name}`
                              ),
                              React.createElement(
                                "div",
                                { className: "relative w-full mt-2" },
                                [
                                  React.createElement("input", {
                                    type: "text",
                                    value: teamSearch[`${match.id}-team2Club`] || match.team2Club || "",
                                    onChange: (e) => handleTeamSearch(match.id, "team2Club", e.target.value),
                                    placeholder: "Csapat keresése...",
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"
                                  }),
                                  showSuggestions[`${match.id}-team2Club`] && React.createElement(
                                    "div",
                                    { className: "absolute z-10 bg-gray-800 border border-gray-600 rounded-2xl mt-1 w-full max-h-40 overflow-y-auto" },
                                    teams
                                      .filter(team => team.toLowerCase().includes((teamSearch[`${match.id}-team2Club`] || "").toLowerCase()))
                                      .slice(0, 5)
                                      .map(team =>
                                        React.createElement(
                                          "div",
                                          {
                                            key: `${match.id}-team2-club-${team}`,
                                            onClick: () => selectTeam(match.id, "team2Club", team),
                                            className: "p-2 text-white text-sm hover:bg-pink-500 cursor-pointer"
                                          },
                                          team
                                        )
                                      )
                                  ),
                                ]
                              ),
                            ]
                          ),
                        ]
                      ),
                      React.createElement(
                        "div",
                        { className: "mt-4 grid grid-cols-2 gap-4 text-gray-400 text-sm" },
                        [
                          React.createElement(
                            "div",
                            { className: "border border-gray-600 rounded-2xl p-2" },
                            [
                              React.createElement("h4", { className: "text-white font-bold text-center" }, "Páros statisztika"),
                              React.createElement("div", { className: "grid grid-cols-2 gap-1 mt-2" }, [
                                React.createElement("span", {}, "Győzelmi arány:"),
                                React.createElement("span", { className: "text-center" }, pair1Stats.winRate.toFixed(1) + "%"),
                                React.createElement("span", {}, "Átlagos lőtt gól:"),
                                React.createElement("span", { className: "text-center" }, pair1Stats.avgGoalsScored.toFixed(2)),
                                React.createElement("span", {}, "Átlagos kapott gól:"),
                                React.createElement("span", { className: "text-center" }, pair1Stats.avgGoalsConceded.toFixed(2)),
                              ]),
                            ]
                          ),
                          React.createElement(
                            "div",
                            { className: "border border-gray-600 rounded-2xl p-2" },
                            [
                              React.createElement("h4", { className: "text-white font-bold text-center" }, "Ellenfél elleni statisztika"),
                              React.createElement("div", { className: "grid grid-cols-2 gap-1 mt-2" }, [
                                React.createElement("span", {}, "Győzelmi arány:"),
                                React.createElement("span", { className: "text-center" }, headToHeadStats.winRate.toFixed(1) + "%"),
                                React.createElement("span", {}, "Átlagos lőtt gól:"),
                                React.createElement("span", { className: "text-center" }, headToHeadStats.avgGoalsScored.toFixed(2)),
                                React.createElement("span", {}, "Átlagos kapott gól:"),
                                React.createElement("span", { className: "text-center" }, headToHeadStats.avgGoalsConceded.toFixed(2)),
                              ]),
                            ]
                          ),
                          React.createElement(
                            "div",
                            { className: "border border-gray-600 rounded-2xl p-2" },
                            [
                              React.createElement("h4", { className: "text-white font-bold text-center" }, "Páros statisztika"),
                              React.createElement("div", { className: "grid grid-cols-2 gap-1 mt-2" }, [
                                React.createElement("span", {}, "Győzelmi arány:"),
                                React.createElement("span", { className: "text-center" }, pair2Stats.winRate.toFixed(1) + "%"),
                                React.createElement("span", {}, "Átlagos lőtt gól:"),
                                React.createElement("span", { className: "text-center" }, pair2Stats.avgGoalsScored.toFixed(2)),
                                React.createElement("span", {}, "Átlagos kapott gól:"),
                                React.createElement("span", { className: "text-center" }, pair2Stats.avgGoalsConceded.toFixed(2)),
                              ]),
                            ]
                          ),
                        ]
                      ),
                      match.resting && React.createElement(
                        "p",
                        { className: "text-gray-400 text-sm mt-4 text-center" },
                        `😴 Pihen: ${match.resting.name}`
                      ),
                    ]
                  );
                })
              ),
              matches.length > 0 && React.createElement(
                "button",
                {
                  onClick: handleCloseTournament,
                  className: "mt-8 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow"
                },
                "LEZÁRÁS"
              ),
            ]
          ),
        ]
      );
    };

    const Rounds = ({ tournaments, diceGames, players, setTournaments }) => {
      const [viewMode, setViewMode] = useState("fifa");
      const [selectedTournament, setSelectedTournament] = useState(null);
      const [selectedDiceGame, setSelectedDiceGame] = useState(null);
      const [scrollPosition, setScrollPosition] = useState(0);
      const [tempMatches, setTempMatches] = useState([]);
      const [teamSearch, setTeamSearch] = useState({});
      const [showSuggestions, setShowSuggestions] = useState({});
      const [showConfirmModal, setShowConfirmModal] = useState(false);
      const [hasChanges, setHasChanges] = useState(false);

      const handleTeamSearch = (matchId, team, value) => {
        setTeamSearch({ ...teamSearch, [`${matchId}-${team}`]: value });
        setShowSuggestions({ ...showSuggestions, [`${matchId}-${team}`]: value !== "" });
        if (value === "") {
          setTempMatches(tempMatches.map(match =>
            match.id === matchId ? { ...match, [team]: "" } : match
          ));
        }
        setHasChanges(true);
      };

      const selectTeam = (matchId, team, selectedTeam) => {
        setTempMatches(tempMatches.map(match =>
          match.id === matchId
            ? { ...match, [team]: selectedTeam }
            : match
        ));
        setTeamSearch({ ...teamSearch, [`${matchId}-${team}`]: selectedTeam });
        setShowSuggestions({ ...showSuggestions, [`${matchId}-${team}`]: false });
        setHasChanges(true);
      };

      const handleOpenModal = (item, type) => {
        setScrollPosition(window.scrollY);
        if (type === "tournament") {
          setSelectedTournament(item);
          setTempMatches([...item.matches]);
        } else {
          setSelectedDiceGame(item);
        }
      };

      const handleCloseModal = () => {
        if (hasChanges) {
          setShowConfirmModal(true);
        } else {
          setSelectedTournament(null);
          setSelectedDiceGame(null);
          setTempMatches([]);
          setTeamSearch({});
          setShowSuggestions({});
          setHasChanges(false);
          window.scrollTo(0, scrollPosition);
        }
      };

      const handleConfirmClose = (save) => {
        if (save) {
          setTournaments(tournaments.map(tournament =>
            tournament.timestamp === selectedTournament.timestamp
              ? { ...tournament, matches: tempMatches }
              : tournament
          ));
        }
        setShowConfirmModal(false);
        setSelectedTournament(null);
        setTempMatches([]);
        setTeamSearch({});
        setShowSuggestions({});
        setHasChanges(false);
        window.scrollTo(0, scrollPosition);
      };

      const sortedTournaments = [...tournaments].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      const sortedDiceGames = [...diceGames].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-75 p-6 rounded-2xl" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Archív"),
              React.createElement(
                "div",
                { className: "flex gap-4 mt-6" },
                [
                  React.createElement(
                    "button",
                    {
                      onClick: () => setViewMode("fifa"),
                      className: `px-4 py-2 rounded-2xl ${viewMode === "fifa" ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "🎮 FIFA"
                  ),
                  React.createElement(
                    "button",
                    {
                      onClick: () => setViewMode("dice"),
                      className: `px-4 py-2 rounded-2xl ${viewMode === "dice" ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "🎲 DICE"
                  ),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-6 space-y-4" },
                viewMode === "fifa" ? sortedTournaments.map((tournament, index) => {
                  const displayIndex = sortedTournaments.length - index;
                  return React.createElement(
                    "div",
                    {
                      key: `tournament-${index}`,
                      className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all cursor-pointer",
                      onClick: () => handleOpenModal(tournament, "tournament")
                    },
                    React.createElement("p", { className: "text-gray-400" }, 
                      React.createElement("span", { className: "text-white font-bold" }, `${displayIndex}.`), ` - ${new Date(tournament.timestamp).toLocaleString("hu-HU")}`
                    )
                  );
                }) : sortedDiceGames.map((diceGame, index) => {
                  const displayIndex = sortedDiceGames.length - index;
                  return React.createElement(
                    "div",
                    {
                      key: `dicegame-${index}`,
                      className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all cursor-pointer",
                      onClick: () => handleOpenModal(diceGame, "dicegame")
                    },
                    React.createElement("p", { className: "text-gray-400" }, 
                      React.createElement("span", { className: "text-white font-bold" }, `${displayIndex}.`), ` - ${new Date(diceGame.timestamp).toLocaleString("hu-HU")}`
                    )
                  );
                })
              ),
              selectedTournament && React.createElement(
                "div",
                { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4" },
                React.createElement(
                  "div",
                  { className: "bg-gray-900 p-6 rounded-2xl w-full max-w-lg modal-content" },
                  [
                    React.createElement(
                      "button",
                      {
                        onClick: handleCloseModal,
                        className: "absolute top-2 right-2 text-white text-2xl close-btn"
                      },
                      "✕"
                    ),
                    React.createElement("h3", { className: "text-2xl font-bold text-white" }, 
                      `Bajnokság #${sortedTournaments.length - sortedTournaments.findIndex(t => t.timestamp === selectedTournament.timestamp)} - ${new Date(selectedTournament.timestamp).toLocaleString("hu-HU")}`
                    ),
                    React.createElement(
                      "div",
                      { className: "mt-4 space-y-6" },
                      [
                        React.createElement(
                          "div",
                          { className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500" },
                          [
                            React.createElement("h4", { className: "text-2xl font-bold text-white text-center" }, "🏆"),
                            React.createElement(
                              "div",
                              { className: "grid grid-cols-5 gap-2 text-gray-400 text-sm mt-2" },
                              [
                                React.createElement("span", { className: "font-bold" }, ""),
                                React.createElement("span", { className: "font-bold" }, ""),
                                React.createElement("span", { className: "font-bold text-center" }, "W"),
                                React.createElement("span", { className: "font-bold text-center" }, "LG"),
                                React.createElement("span", { className: "font-bold text-center" }, "KG"),
                                ...calculatePlayerStats(selectedTournament.matches).map((stat, index) => [
                                  React.createElement("span", { key: `stat-${index}-pos`, className: "text-pink-500 font-bold" }, `${index + 1}.`),
                                  React.createElement("span", { key: `stat-${index}-name` }, stat.player ? stat.player.name : "Ismeretlen"),
                                  React.createElement("span", { key: `stat-${index}-wins`, className: "text-center text-pink-500 font-bold" }, stat.wins),
                                  React.createElement("span", { key: `stat-${index}-gs`, className: "text-center" }, stat.goalsScored),
                                  React.createElement("span", { key: `stat-${index}-gc`, className: "text-center" }, stat.goalsConceded),
                                ]),
                              ]
                            ),
                          ]
                        ),
                        tempMatches.map((match, index) =>
                          React.createElement(
                            "div",
                            { key: match.id, className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all" },
                            [
                              React.createElement("h4", { className: "text-gray-400 text-sm text-center font-medium" }, `#${index + 1}`),
                              React.createElement(
                                "div",
                                { className: "flex flex-col sm:flex-row justify-between items-center mt-4 space-y-4 sm:space-y-0 sm:space-x-4" },
                                [
                                  React.createElement(
                                    "div",
                                    { className: "flex-1 min-w-0 max-w-[120px] flex flex-col items-start" },
                                    [
                                      React.createElement(
                                        "span",
                                        { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                        `${match.team1[0].name} + ${match.team1[1].name}`
                                      ),
                                      React.createElement(
                                        "div",
                                        { className: "relative w-full mt-2" },
                                        [
                                          React.createElement("input", {
                                            type: "text",
                                            value: teamSearch[`${match.id}-team1Club`] || match.team1Club || "",
                                            onChange: (e) => handleTeamSearch(match.id, "team1Club", e.target.value),
                                            placeholder: "Csapat keresése...",
                                            className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"
                                          }),
                                          showSuggestions[`${match.id}-team1Club`] && React.createElement(
                                            "div",
                                            { className: "absolute z-10 bg-gray-800 border border-gray-600 rounded-2xl mt-1 w-full max-h-40 overflow-y-auto" },
                                            initialTeams
                                              .filter(team => team.toLowerCase().includes((teamSearch[`${match.id}-team1Club`] || "").toLowerCase()))
                                              .slice(0, 5)
                                              .map(team =>
                                                React.createElement(
                                                  "div",
                                                  {
                                                    key: `${match.id}-team1-club-${team}`,
                                                    onClick: () => selectTeam(match.id, "team1Club", team),
                                                    className: "p-2 text-white text-sm hover:bg-pink-500 cursor-pointer"
                                                  },
                                                  team
                                                )
                                              )
                                          ),
                                        ]
                                      ),
                                    ]
                                  ),
                                  React.createElement(
                                    "div",
                                    { className: "flex flex-col items-center" },
                                    [
                                      React.createElement(
                                        "div",
                                        { className: "flex justify-center items-center" },
                                        [
                                          React.createElement("input", {
                                            type: "number",
                                            inputMode: "numeric",
                                            value: match.goals.team1,
                                            onChange: (e) => {
                                              setTempMatches(tempMatches.map(m =>
                                                m.id === match.id ? { ...m, goals: { ...m.goals, team1: e.target.value } } : m
                                              ));
                                              setHasChanges(true);
                                            },
                                            className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-20 h-12 text-4xl text-center"
                                          }),
                                          React.createElement("div", { className: "text-gray-400 font-bold mx-2 text-lg" }, "vs"),
                                          React.createElement("input", {
                                            type: "number",
                                            inputMode: "numeric",
                                            value: match.goals.team2,
                                            onChange: (e) => {
                                              setTempMatches(tempMatches.map(m =>
                                                m.id === match.id ? { ...m, goals: { ...m.goals, team2: e.target.value } } : m
                                              ));
                                              setHasChanges(true);
                                            },
                                            className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-20 h-12 text-4xl text-center"
                                          }),
                                        ]
                                      ),
                                      React.createElement(
                                        "span",
                                        { className: `mt-2 text-lg ${match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "text-green-500" : "text-gray-500"}` },
                                        match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "✅" : "☑️"
                                      ),
                                    ]
                                  ),
                                  React.createElement(
                                    "div",
                                    { className: "flex-1 min-w-0 max-w-[120px] flex flex-col items-end" },
                                    [
                                      React.createElement(
                                        "span",
                                        { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                        `${match.team2[0].name} + ${match.team2[1].name}`
                                      ),
                                      React.createElement(
                                        "div",
                                        { className: "relative w-full mt-2" },
                                        [
                                          React.createElement("input", {
                                            type: "text",
                                            value: teamSearch[`${match.id}-team2Club`] || match.team2Club || "",
                                            onChange: (e) => handleTeamSearch(match.id, "team2Club", e.target.value),
                                            placeholder: "Csapat keresése...",
                                            className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"
                                          }),
                                          showSuggestions[`${match.id}-team2Club`] && React.createElement(
                                            "div",
                                            { className: "absolute z-10 bg-gray-800 border border-gray-600 rounded-2xl mt-1 w-full max-h-40 overflow-y-auto" },
                                            initialTeams
                                              .filter(team => team.toLowerCase().includes((teamSearch[`${match.id}-team2Club`] || "").toLowerCase()))
                                              .slice(0, 5)
                                              .map(team =>
                                                React.createElement(
                                                  "div",
                                                  {
                                                    key: `${match.id}-team2-club-${team}`,
                                                    onClick: () => selectTeam(match.id, "team2Club", team),
                                                    className: "p-2 text-white text-sm hover:bg-pink-500 cursor-pointer"
                                                  },
                                                  team
                                                )
                                              )
                                          ),
                                        ]
                                      ),
                                    ]
                                  ),
                                ]
                              ),
                              match.resting && React.createElement(
                                "p",
                                { className: "text-gray-400 text-sm mt-4 text-center" },
                                `😴 Pihen: ${match.resting.name}`
                              ),
                            ]
                          )
                        ),
                        showConfirmModal && React.createElement(
                          "div",
                          { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4" },
                          React.createElement(
                            "div",
                            { className: "bg-gray-900 p-6 rounded-2xl w-full max-w-sm text-center" },
                            [
                              React.createElement("h3", { className: "text-xl font-bold text-white" }, "Mentés?"),
                              React.createElement("p", { className: "text-gray-400 mt-2" }, "Nem mentett változtatásaid vannak. Menti őket?"),
                              React.createElement(
                                "div",
                                { className: "mt-6 flex justify-center space-x-4" },
                                [
                                  React.createElement(
                                    "button",
                                    {
                                      onClick: () => handleConfirmClose(true),
                                      className: "bg-pink-500 text-white px-4 py-2 rounded-2xl hover:bg-pink-400 active:scale-95 transition-all glow"
                                    },
                                    "Igen"
                                  ),
                                  React.createElement(
                                    "button",
                                    {
                                      onClick: () => handleConfirmClose(false),
                                      className: "bg-gray-600 text-white px-4 py-2 rounded-2xl hover:bg-gray-500 active:scale-95 transition-all"
                                    },
                                    "Nem"
                                  ),
                                ]
                              ),
                            ]
                          )
                        ),
                      ]
                    ),
                  ]
                )
              ),
              selectedDiceGame && React.createElement(
                "div",
                { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4" },
                React.createElement(
                  "div",
                  { className: "bg-gray-900 p-6 rounded-2xl w-full max-w-lg modal-content" },
                  [
                    React.createElement(
                      "button",
                      {
                        onClick: handleCloseModal,
                        className: "absolute top-2 right-2 text-white text-2xl close-btn"
                      },
                      "✕"
                    ),
                    React.createElement("h3", { className: "text-2xl font-bold text-white" }, 
                      `Kockajáték #${sortedDiceGames.length - sortedDiceGames.findIndex(d => d.timestamp === selectedDiceGame.timestamp)} - ${new Date(selectedDiceGame.timestamp).toLocaleString("hu-HU")}`
                    ),
                    React.createElement(
                      "div",
                      { className: "mt-4 space-y-4" },
                      [
                        React.createElement(
                          "div",
                          { className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500" },
                          [
                            React.createElement("h4", { className: "text-2xl font-bold text-white text-center" }, "Eredmények"),
                            React.createElement(
                              "div",
                              { className: "grid grid-cols-2 gap-2 text-gray-400 text-sm mt-2" },
                              [
                                React.createElement("span", { className: "font-bold" }, "Játékos"),
                                React.createElement("span", { className: "font-bold text-center" }, "Helyezés"),
                                ...selectedDiceGame.results.map((result, index) => [
                                  React.createElement("span", { key: `result-${index}-name` }, 
                                    players.find(p => p.id === result.playerId)?.name || "Ismeretlen"
                                  ),
                                  React.createElement("span", { key: `result-${index}-pos`, className: "text-center text-pink-500 font-bold" }, result.position),
                                ]),
                              ]
                            ),
                          ]
                        ),
                      ]
                    ),
                  ]
                )
              ),
            ]
          ),
        ]
      );
    };

    const Stats = ({ tournaments, diceGames, players }) => {
      const topTeams = calculateTopTeams(tournaments);
      const playerStats = calculatePlayerStats(tournaments.flatMap(t => t.matches));
      const [selectedPair1, setSelectedPair1] = useState([]);
      const [selectedPair2, setSelectedPair2] = useState([]);
      const [headToHeadStats, setHeadToHeadStats] = useState(null);

      const handlePairSelect = (playerId, setPair) => {
        setPair(prev => {
          if (prev.includes(playerId)) {
            return prev.filter(id => id !== playerId);
          } else if (prev.length < 2) {
            return [...prev, playerId];
          }
          return prev;
        });
      };

      useEffect(() => {
        if (selectedPair1.length === 2 && selectedPair2.length === 2) {
          setHeadToHeadStats(calculateHeadToHeadStats(tournaments, 
            selectedPair1.map(id => players.find(p => p.id === id)),
            selectedPair2.map(id => players.find(p => p.id === id))
          ));
        } else {
          setHeadToHeadStats(null);
        }
      }, [selectedPair1, selectedPair2, tournaments, players]);

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-75 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Statisztikák"),
              React.createElement(
                "div",
                { className: "mt-8" },
                [
                  React.createElement("h3", { className: "text-2xl font-bold text-white" }, "TOP FIFA Csapatok"),
                  topTeams.length > 0 ? React.createElement(
                    "div",
                    { className: "mt-4 grid grid-cols-4 gap-2 text-gray-400 text-sm" },
                    [
                      React.createElement("span", { className: "font-bold" }, "Csapat"),
                      React.createElement("span", { className: "font-bold text-center" }, "Meccsek"),
                      React.createElement("span", { className: "font-bold text-center" }, "Győzelmi arány"),
                      React.createElement("span", { className: "font-bold text-center" }, "xG"),
                      ...topTeams.flatMap((team, index) => [
                        React.createElement("span", { key: `team-${index}-name`, className: "text-white" }, team.name),
                        React.createElement("span", { key: `team-${index}-matches`, className: "text-center" }, team.matches),
                        React.createElement("span", { key: `team-${index}-winrate`, className: "text-center" }, 
                          `${team.wins} (${team.winRate.toFixed(1)}%)`
                        ),
                        React.createElement("span", { key: `team-${index}-xg`, className: "text-center" }, team.xG.toFixed(2)),
                      ]),
                    ]
                  ) : React.createElement("p", { className: "mt-4 text-gray-400" }, "Még nincs elég adat a statisztikához."),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-8" },
                [
                  React.createElement("h3", { className: "text-2xl font-bold text-white" }, "Játékos Statisztikák"),
                  playerStats.length > 0 ? React.createElement(
                    "div",
                    { className: "mt-4 grid grid-cols-5 gap-2 text-gray-400 text-sm" },
                    [
                      React.createElement("span", { className: "font-bold" }, "#"),
                      React.createElement("span", { className: "font-bold" }, "Játékos"),
                      React.createElement("span", { className: "font-bold text-center" }, "Győzelmek"),
                      React.createElement("span", { className: "font-bold text-center" }, "Lőtt gól"),
                      React.createElement("span", { className: "font-bold text-center" }, "Kapott gól"),
                      ...playerStats.map((stat, index) => [
                        React.createElement("span", { key: `stat-${index}-pos`, className: "text-pink-500 font-bold" }, `${index + 1}.`),
                        React.createElement("span", { key: `stat-${index}-name` }, stat.player.name),
                        React.createElement("span", { key: `stat-${index}-wins`, className: "text-center text-pink-500 font-bold" }, stat.wins),
                        React.createElement("span", { key: `stat-${index}-gs`, className: "text-center" }, stat.goalsScored),
                        React.createElement("span", { key: `stat-${index}-gc`, className: "text-center" }, stat.goalsConceded),
                      ]),
                    ]
                  ) : React.createElement("p", { className: "mt-4 text-gray-400" }, "Még nincs elég adat a statisztikához."),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-8" },
                [
                  React.createElement("h3", { className: "text-2xl font-bold text-white" }, "Páros Ellenfél Ellen"),
                  React.createElement(
                    "div",
                    { className: "mt-4 grid grid-cols-2 gap-4" },
                    [
                      React.createElement(
                        "div",
                        {},
                        [
                          React.createElement("h4", { className: "text-xl font-bold text-white" }, "Páros 1"),
                          players.map(player =>
                            React.createElement(
                              "button",
                              {
                                key: `pair1-${player.id}`,
                                onClick: () => handlePairSelect(player.id, setSelectedPair1),
                                className: `mt-2 px-4 py-2 rounded-2xl text-white ${selectedPair1.includes(player.id) ? "bg-pink-500" : "bg-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                              },
                              player.name
                            )
                          ),
                        ]
                      ),
                      React.createElement(
                        "div",
                        {},
                        [
                          React.createElement("h4", { className: "text-xl font-bold text-white" }, "Páros 2"),
                          players.map(player =>
                            React.createElement(
                              "button",
                              {
                                key: `pair2-${player.id}`,
                                onClick: () => handlePairSelect(player.id, setSelectedPair2),
                                className: `mt-2 px-4 py-2 rounded-2xl text-white ${selectedPair2.includes(player.id) ? "bg-pink-500" : "bg-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                              },
                              player.name
                            )
                          ),
                        ]
                      ),
                    ]
                  ),
                  headToHeadStats && React.createElement(
                    "div",
                    { className: "mt-4 bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500" },
                    [
                      React.createElement("h4", { className: "text-xl font-bold text-white text-center" }, "Ellenfél Ellen Statisztika"),
                      React.createElement(
                        "div",
                        { className: "grid grid-cols-2 gap-2 text-gray-400 text-sm mt-2" },
                        [
                          React.createElement("span", {}, "Meccsek:"),
                          React.createElement("span", { className: "text-center" }, headToHeadStats.matches),
                          React.createElement("span", {}, "Győzelmi arány:"),
                          React.createElement("span", { className: "text-center" }, headToHeadStats.winRate.toFixed(1) + "%"),
                          React.createElement("span", {}, "Átlagos lőtt gól:"),
                          React.createElement("span", { className: "text-center" }, headToHeadStats.avgGoalsScored.toFixed(2)),
                          React.createElement("span", {}, "Átlagos kapott gól:"),
                          React.createElement("span", { className: "text-center" }, headToHeadStats.avgGoalsConceded.toFixed(2)),
                        ]
                      ),
                    ]
                  ),
                ]
              ),
            ]
          ),
        ]
      );
    };

    const App = () => {
      const [players, setPlayers] = useState(initialPlayers);
      const [teams, setTeams] = useState(initialTeams);
      const [tournaments, setTournaments] = useState([]);
      const [diceGames, setDiceGames] = useState([]);
      const [currentPage, setCurrentPage] = useState("home");

      useEffect(() => {
        const hash = window.location.hash.replace("#", "");
        if (hash) setCurrentPage(hash);
      }, []);

      const addPlayer = (player) => {
        setPlayers([...players, player]);
      };

      const addCustomTeam = (team) => {
        setTeams([...teams, team]);
      };

      const addTournament = (tournament) => {
        setTournaments([...tournaments, tournament]);
      };

      const addDiceGame = (diceGame) => {
        setDiceGames([...diceGames, diceGame]);
      };

      const pageComponents = {
        home: React.createElement(Home, { tournaments }),
        players: React.createElement(Players, { players, setPlayers, addPlayer, teams, addCustomTeam }),
        generate: React.createElement(GenerateTournament, { players, addTournament, teams, tournaments }),
        dicegame: React.createElement(DiceGame, { players, addDiceGame }),
        stats: React.createElement(Stats, { tournaments, diceGames, players }),
        rounds: React.createElement(Rounds, { tournaments, diceGames, players, setTournaments }),
      };

      return React.createElement(
        React.Fragment,
        null,
        React.createElement(NavBar, { setCurrentPage, currentPage }),
        pageComponents[currentPage] || pageComponents.home
      );
    };

    ReactDOM.render(React.createElement(App), document.getElementById("root"));
  </script>
</body>
</html>
