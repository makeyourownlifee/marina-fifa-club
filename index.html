<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marina FIFA Club</title>
  <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <link href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .fade-in {
      animation: fadeIn 0.3s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .glow:hover {
      box-shadow: 0 0 10px rgba(236, 72, 153, 0.5);
    }
    .page-bg {
      background-image: url('https://w0.peakpx.com/wallpaper/355/120/HD-wallpaper-champions-league-icio-uefa-champions-league.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height: 100vh;
    }
    @media (max-width: 640px) {
      .mb-mobile {
        margin-bottom: 4rem;
      }
    }
  </style>
</head>
<body class="bg-gray-900">
  <div id="root"></div>
  <script type="text/javascript">
    const { useState, useEffect } = React;

    // Mock játékosok
    const initialPlayers = [
      { id: 1, name: "Mell", avatar: null },
      { id: 2, name: "Bazsi", avatar: null },
      { id: 3, name: "Peti", avatar: null },
      { id: 4, name: "Lacus", avatar: null },
      { id: 5, name: "Benyó", avatar: null },
    ];

    // SoFIFA FC 25 top 300 klubcsapat és válogatottak (részleges lista)
    const initialTeams = [
      "Real Madrid", "FC Barcelona", "Atlético Madrid", "Sevilla FC", "Real Sociedad",
      "Villarreal", "Real Betis", "Celta Vigo", "Valencia CF", "Athletic Bilbao",
      "Getafe CF", "Espanyol", "Mallorca", "Osasuna", "Granada CF",
      "Manchester City", "Liverpool", "Chelsea", "Arsenal", "Manchester United",
      "Tottenham Hotspur", "West Ham United", "Leicester City", "Everton", "Aston Villa",
      "Newcastle United", "Brighton", "Wolves", "Crystal Palace", "Southampton",
      "Bayern Munich", "Borussia Dortmund", "RB Leipzig", "Bayer Leverkusen", "VfL Wolfsburg",
      "Eintracht Frankfurt", "Borussia Mönchengladbach", "FC Köln", "Hoffenheim", "Union Berlin",
      "Juventus", "Inter Milan", "AC Milan", "Napoli", "AS Roma",
      "Lazio", "Fiorentina", "Atalanta", "Sassuolo", "Torino",
      "PSG", "Olympique Marseille", "Lyon", "Monaco", "Lille",
      "Nice", "Rennes", "Lens", "Strasbourg", "Bordeaux",
      "Ajax", "PSV Eindhoven", "Feyenoord", "Benfica", "Porto",
      "Sporting CP", "Shakhtar Donetsk", "Celtic", "Rangers", "Anderlecht",
      "Brazil", "Argentina", "France", "Germany", "Spain",
      "England", "Italy", "Portugal", "Netherlands", "Belgium",
      "Galatasaray", "Fenerbahçe", "Besiktas", "Zenit", "Dynamo Kyiv",
    ];

    // Véletlenszerű párosítás generálás
    const shuffleArray = (array) => {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    };

    const generateTournament = (players) => {
      const matches = [];
      const shuffledPlayers = shuffleArray([...players]);
      const numPlayers = players.length;

      if (numPlayers === 5) {
        const pairs = [
          [[0, 1], [2, 3]],
          [[0, 2], [1, 4]],
          [[0, 3], [1, 4]],
          [[0, 4], [2, 3]],
          [[1, 3], [2, 4]],
        ];
        pairs.forEach(([team1, team2], index) => {
          matches.push({
            id: `match-5p-${index}-${Date.now()}`,
            team1: [shuffledPlayers[team1[0]], shuffledPlayers[team1[1]]],
            team2: [shuffledPlayers[team2[0]], shuffledPlayers[team2[1]]],
            goals: { team1: "", team2: "" },
            team1Club: "",
            team2Club: "",
            resting: shuffledPlayers[4 - index % 5],
            confirmed: false,
          });
        });
      } else if (numPlayers === 4) {
        const pairs = [
          [[0, 1], [2, 3]],
          [[0, 2], [1, 3]],
          [[0, 3], [1, 2]],
          [[1, 2], [0, 3]],
          [[1, 3], [0, 2]],
          [[2, 3], [0, 1]],
        ];
        pairs.forEach(([team1, team2], index) => {
          matches.push({
            id: `match-4p-${index}-${Date.now()}`,
            team1: [shuffledPlayers[team1[0]], shuffledPlayers[team1[1]]],
            team2: [shuffledPlayers[team2[0]], shuffledPlayers[team2[1]]],
            goals: { team1: "", team2: "" },
            team1Club: "",
            team2Club: "",
            resting: null,
            confirmed: false,
          });
        });
      }
      return matches;
    };

    // TOP FIFA Csapatok statisztika számítás
    const calculateTopTeams = (tournaments) => {
      const teamStats = {};
      tournaments.forEach(tournament => {
        tournament.matches.forEach(match => {
          if (match.team1Club && match.goals.team1 !== "" && match.goals.team2 !== "") {
            if (!teamStats[match.team1Club]) {
              teamStats[match.team1Club] = { matches: 0, wins: 0, goals: 0 };
            }
            teamStats[match.team1Club].matches += 1;
            teamStats[match.team1Club].goals += parseInt(match.goals.team1) || 0;
            if (parseInt(match.goals.team1) > parseInt(match.goals.team2)) {
              teamStats[match.team1Club].wins += 1;
            }
          }
          if (match.team2Club && match.goals.team1 !== "" && match.goals.team2 !== "") {
            if (!teamStats[match.team2Club]) {
              teamStats[match.team2Club] = { matches: 0, wins: 0, goals: 0 };
            }
            teamStats[match.team2Club].matches += 1;
            teamStats[match.team2Club].goals += parseInt(match.goals.team2) || 0;
            if (parseInt(match.goals.team2) > parseInt(match.goals.team1)) {
              teamStats[match.team2Club].wins += 1;
            }
          }
        });
      });

      const topTeams = Object.keys(teamStats)
        .map(team => ({
          name: team,
          winRate: (teamStats[team].wins / teamStats[team].matches) * 100,
          xG: teamStats[team].goals / teamStats[team].matches,
        }))
        .filter(team => teamStats[team.name].matches >= 1)
        .sort((a, b) => b.winRate - a.winRate)
        .slice(0, 5);

      return topTeams;
    };

    // Komponensek
    const NavBar = ({ setCurrentPage, currentPage }) => {
      const handleNavClick = (page) => {
        try {
          console.log("Nav clicked, setting page to:", page);
          setCurrentPage(page);
          window.location.hash = page;
        } catch (error) {
          console.error("Error in handleNavClick:", error);
        }
      };

      return React.createElement(
        "nav",
        { className: "fixed bottom-0 w-full bg-gray-800 bg-opacity-90 text-white flex justify-around py-4 shadow-lg" },
        [
          React.createElement(
            "a",
            {
              key: "nav-home",
              href: "#home",
              onClick: () => handleNavClick("home"),
              className: `flex items-center transition-all ${currentPage === "home" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "home" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-players",
              href: "#players",
              onClick: () => handleNavClick("players"),
              className: `flex items-center transition-all ${currentPage === "players" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "players" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-generate",
              href: "#generate",
              onClick: () => handleNavClick("generate"),
              className: `flex items-center transition-all ${currentPage === "generate" ? "border-b-2 border-pink-500 text-pink-500 shadow-[0_0_5px_rgba(236,72,153,0.5)]" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-8 h-8 ${currentPage === "generate" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M8 5v10l10-5L8 5z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-dicegame",
              href: "#dicegame",
              onClick: () => handleNavClick("dicegame"),
              className: `flex items-center transition-all ${currentPage === "dicegame" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "dicegame" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M3 3h14v14H3V3zm2 2v10h10V5H5zm2 2h2v2H7V7zm0 4h2v2H7v-2zm4-4h2v2h-2V7zm0 4h2v2h-2v-2zm4-4h2v2h-2V7z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-stats",
              href: "#stats",
              onClick: () => handleNavClick("stats"),
              className: `flex items-center transition-all ${currentPage === "stats" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "stats" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M2 3h16v2H2V3zm0 4h4v10H2V7zm6 0h4v10H8V7zm6 0h4v10h-4V7z" })
            )
          ),
          React.createElement(
            "a",
            {
              key: "nav-rounds",
              href: "#rounds",
              onClick: () => handleNavClick("rounds"),
              className: `flex items-center transition-all ${currentPage === "rounds" ? "border-b-2 border-pink-500 text-pink-500" : "text-pink-500 hover:text-pink-400"}`
            },
            React.createElement(
              "svg",
              { className: `w-6 h-6 ${currentPage === "rounds" ? "text-pink-500" : "text-pink-500"}`, fill: "currentColor", viewBox: "0 0 20 20" },
              React.createElement("path", { d: "M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" })
            )
          ),
        ]
      );
    };

    const Home = ({ tournaments }) => {
      const topTeams = calculateTopTeams(tournaments);

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        React.createElement(
          "div",
          { className: "bg-gray-900 bg-opacity-85 p-6 rounded-2xl" },
          [
            React.createElement("h1", { className: "text-4xl font-bold text-white text-center" }, "Marina FIFA Club"),
            React.createElement("p", { className: "text-center mt-6 text-gray-400 text-lg font-light" }, "Üdv a bajnokság appban! Generálj egy új bajnokságot, vagy játssz egy kockajátékot!"),
            React.createElement(
              "div",
              { className: "mt-8" },
              [
                React.createElement("h2", { className: "text-2xl font-bold text-white" }, "TOP FIFA Csapatok"),
                topTeams.length > 0 ? React.createElement(
                  "div",
                  { className: "mt-4 grid grid-cols-3 gap-2 text-gray-400 text-sm" },
                  [
                    React.createElement("span", { className: "font-bold" }, "Csapat"),
                    React.createElement("span", { className: "font-bold text-center" }, "Győzelmi arány (%)"),
                    React.createElement("span", { className: "font-bold text-center" }, "xG (gól/meccs)"),
                    ...topTeams.flatMap((team, index) => [
                      React.createElement("span", { key: `team-${index}-name`, className: "text-white" }, team.name),
                      React.createElement("span", { key: `team-${index}-winrate`, className: "text-center" }, team.winRate.toFixed(1)),
                      React.createElement("span", { key: `team-${index}-xg`, className: "text-center" }, team.xG.toFixed(2)),
                    ]),
                  ]
                ) : React.createElement("p", { className: "mt-4 text-gray-400" }, "Még nincs elég adat a statisztikához. Játssz néhány meccset!")
              ]
            ),
          ]
        )
      );
    };

    const Players = ({ players, addPlayer }) => {
      const [newPlayerName, setNewPlayerName] = useState("");

      const handleAddPlayer = () => {
        if (newPlayerName.trim()) {
          addPlayer({
            id: players.length + 1,
            name: newPlayerName,
            avatar: null,
          });
          setNewPlayerName("");
        }
      };

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-85 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Játékosok"),
              React.createElement(
                "div",
                { className: "grid grid-cols-1 gap-4 mt-6" },
                players.map(player =>
                  React.createElement(
                    "div",
                    { key: `player-${player.id}`, className: "flex items-center bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all" },
                    [
                      React.createElement(
                        "div",
                        { className: "w-12 h-12 rounded-full bg-pink-500 flex items-center justify-center mr-4 text-white text-lg font-bold" },
                        player.name.charAt(0).toUpperCase()
                      ),
                      React.createElement("span", { className: "text-white font-medium text-lg" }, player.name),
                    ]
                  )
                )
              ),
              React.createElement(
                "div",
                { className: "mt-6" },
                [
                  React.createElement("input", {
                    type: "text",
                    value: newPlayerName,
                    onChange: (e) => setNewPlayerName(e.target.value),
                    placeholder: "Új játékos neve",
                    className: "border border-gray-600 bg-gray-800 text-white p-3 rounded-2xl w-full focus:outline-none focus:ring-2 focus:ring-pink-500",
                  }),
                  React.createElement(
                    "button",
                    {
                      onClick: handleAddPlayer,
                      className: "mt-4 bg-gray-200 text-gray-800 p-3 rounded-2xl w-full hover:bg-gray-100 active:scale-95 transition-all glow"
                    },
                    "Játékos hozzáadása"
                  ),
                ]
              ),
            ]
          ),
        ]
      );
    };

    const DiceGame = ({ players, addDiceGame }) => {
      const [selectedPlayers, setSelectedPlayers] = useState([]);
      const [isTie, setIsTie] = useState(false);

      const handlePlayerSelect = (playerId) => {
        if (selectedPlayers.includes(playerId)) {
          setSelectedPlayers(selectedPlayers.filter(id => id !== playerId));
        } else {
          setSelectedPlayers([...selectedPlayers, playerId]);
        }
      };

      const handleCloseGame = async () => {
        if (selectedPlayers.length >= 2) {
          const results = selectedPlayers.map((playerId, index) => {
            let position;
            if (isTie && index < 2) {
              position = 1;
            } else if (isTie) {
              position = index + 2;
            } else {
              position = index + 1;
            }
            return { playerId, position };
          });
          try {
            const response = await fetch('/api/diceGames', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ timestamp: new Date().toISOString(), results }),
            });
            if (response.ok) {
              addDiceGame({ timestamp: new Date().toISOString(), results });
              setSelectedPlayers([]);
              setIsTie(false);
            } else {
              console.error('Failed to save dice game');
            }
          } catch (error) {
            console.error('Error saving dice game:', error);
          }
        }
      };

      const getPlayerPosition = (playerId) => {
        const index = selectedPlayers.indexOf(playerId);
        if (index === -1) return null;
        if (isTie && index < 2) return 1;
        if (isTie) return index + 2;
        return index + 1;
      };

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-85 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Kockajáték"),
              React.createElement(
                "button",
                {
                  onClick: () => setIsTie(!isTie),
                  className: `mt-6 px-4 py-2 rounded-2xl ${isTie ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                },
                "DÖNTETLEN"
              ),
              React.createElement(
                "div",
                { className: "mt-6 grid grid-cols-2 gap-2" },
                players.map(player =>
                  React.createElement(
                    "button",
                    {
                      key: `player-select-${player.id}`,
                      onClick: () => handlePlayerSelect(player.id),
                      className: `px-4 py-2 rounded-2xl text-white flex items-center justify-between ${selectedPlayers.includes(player.id) ? "bg-pink-500" : "bg-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    [
                      React.createElement("span", { key: `player-name-${player.id}` }, player.name),
                      selectedPlayers.includes(player.id) && React.createElement(
                        "span",
                        { key: `player-position-${player.id}`, className: "text-white font-bold" },
                        getPlayerPosition(player.id)
                      ),
                    ]
                  )
                )
              ),
              React.createElement(
                "button",
                {
                  onClick: handleCloseGame,
                  disabled: selectedPlayers.length < 2,
                  className: "mt-8 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600"
                },
                "LEZÁRÁS"
              ),
            ]
          ),
        ]
      );
    };

    const GenerateTournament = ({ players, addTournament }) => {
      const [mode, setMode] = useState(5);
      const [selectedPlayers, setSelectedPlayers] = useState([]);
      const [matches, setMatches] = useState([]);
      const [teamSearch, setTeamSearch] = useState({});
      const [showSuggestions, setShowSuggestions] = useState({});
      const [customTeam, setCustomTeam] = useState("");
      const [teams, setTeams] = useState(initialTeams);

      const handlePlayerToggle = (playerId) => {
        if (selectedPlayers.includes(playerId)) {
          setSelectedPlayers(selectedPlayers.filter(id => id !== playerId));
        } else if (selectedPlayers.length < mode) {
          setSelectedPlayers([...selectedPlayers, playerId]);
        }
      };

      const handleGenerate = () => {
        if (selectedPlayers.length === mode) {
          const tournamentPlayers = players.filter(p => selectedPlayers.includes(p.id));
          const generatedMatches = generateTournament(tournamentPlayers);
          setMatches(generatedMatches);
        }
      };

      const handleConfirmMatch = (matchId) => {
        setMatches(matches.map(match =>
          match.id === matchId && match.goals.team1 !== "" && match.goals.team2 !== ""
            ? { ...match, confirmed: !match.confirmed }
            : match
        ));
      };

      const handleCloseTournament = async () => {
        if (matches.length > 0) {
          try {
            const response = await fetch('/api/tournaments', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ matches, timestamp: new Date().toISOString() }),
            });
            if (response.ok) {
              addTournament({ matches, timestamp: new Date().toISOString() });
              setMatches([]);
              setSelectedPlayers([]);
            } else {
              console.error('Failed to save tournament');
            }
          } catch (error) {
            console.error('Error saving tournament:', error);
          }
        }
      };

      const handleTeamSearch = (matchId, team, value) => {
        setTeamSearch({ ...teamSearch, [`${matchId}-${team}`]: value });
        setShowSuggestions({ ...showSuggestions, [`${matchId}-${team}`]: value !== "" });
        if (value === "") {
          setMatches(matches.map(match =>
            match.id === matchId ? { ...match, [team]: "" } : match
          ));
        }
      };

      const selectTeam = (matchId, team, selectedTeam) => {
        setMatches(matches.map(match =>
          match.id === matchId
            ? { ...match, [team]: selectedTeam }
            : match
        ));
        setTeamSearch({ ...teamSearch, [`${matchId}-${team}`]: selectedTeam });
        setShowSuggestions({ ...showSuggestions, [`${matchId}-${team}`]: false });
      };

      const handleAddCustomTeam = () => {
        if (customTeam.trim() && !teams.includes(customTeam.trim())) {
          setTeams([...teams, customTeam.trim()]);
          setCustomTeam("");
        }
      };

      const canGenerate = matches.length === 0 || !matches.some(match => match.goals.team1 !== "" || match.goals.team2 !== "");

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-85 p-6 rounded-2xl mb-mobile" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Bajnokság Generálás"),
              React.createElement(
                "div",
                { className: "flex gap-4 mt-6" },
                [
                  React.createElement(
                    "button",
                    {
                      onClick: () => setMode(5),
                      className: `px-4 py-2 rounded-2xl ${mode === 5 ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "5-játékos"
                  ),
                  React.createElement(
                    "button",
                    {
                      onClick: () => setMode(4),
                      className: `px-4 py-2 rounded-2xl ${mode === 4 ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "4-játékos"
                  ),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-6 grid grid-cols-2 gap-2" },
                players.map(player =>
                  React.createElement(
                    "button",
                    {
                      key: `player-select-${player.id}`,
                      onClick: () => handlePlayerToggle(player.id),
                      disabled: !selectedPlayers.includes(player.id) && selectedPlayers.length >= mode,
                      className: `px-4 py-2 rounded-2xl text-white ${selectedPlayers.includes(player.id) ? "bg-pink-500" : "bg-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600`
                    },
                    player.name
                  )
                )
              ),
              React.createElement(
                "div",
                { className: "mt-6" },
                [
                  React.createElement("input", {
                    type: "text",
                    value: customTeam,
                    onChange: (e) => setCustomTeam(e.target.value),
                    placeholder: "Egyedi csapat neve (pl. Adiddas XI)",
                    className: "border border-gray-600 bg-gray-800 text-white p-3 rounded-2xl w-full focus:outline-none focus:ring-2 focus:ring-pink-500",
                  }),
                  React.createElement(
                    "button",
                    {
                      onClick: handleAddCustomTeam,
                      disabled: !customTeam.trim(),
                      className: "mt-4 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600"
                    },
                    "Egyedi csapat mentése"
                  ),
                ]
              ),
              React.createElement(
                "button",
                {
                  onClick: handleGenerate,
                  disabled: selectedPlayers.length !== mode || !canGenerate,
                  className: "mt-6 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow disabled:bg-gray-600"
                },
                "KEZDÉS"
              ),
              React.createElement(
                "div",
                { className: "mt-8 space-y-6" },
                matches.map((match, index) =>
                  React.createElement(
                    "div",
                    { key: match.id, className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all" },
                    [
                      React.createElement("h3", { className: "text-gray-400 text-sm text-center font-medium" }, `#${index + 1}`),
                      React.createElement(
                        "div",
                        { className: "flex flex-col sm:flex-row justify-between items-center mt-4 space-y-4 sm:space-y-0 sm:space-x-4" },
                        [
                          React.createElement(
                            "div",
                            { className: "flex-1 min-w-0 max-w-[120px] flex flex-col items-start" },
                            [
                              React.createElement(
                                "span",
                                { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                `${match.team1[0].name} + ${match.team1[1].name}`
                              ),
                              React.createElement(
                                "div",
                                { className: "relative w-full mt-2" },
                                [
                                  React.createElement("input", {
                                    type: "text",
                                    value: teamSearch[`${match.id}-team1Club`] || match.team1Club || "",
                                    onChange: (e) => handleTeamSearch(match.id, "team1Club", e.target.value),
                                    placeholder: "Csapat keresése...",
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"
                                  }),
                                  showSuggestions[`${match.id}-team1Club`] && React.createElement(
                                    "div",
                                    { className: "absolute z-10 bg-gray-800 border border-gray-600 rounded-2xl mt-1 w-full max-h-40 overflow-y-auto" },
                                    teams
                                      .filter(team => team.toLowerCase().includes((teamSearch[`${match.id}-team1Club`] || "").toLowerCase()))
                                      .slice(0, 5)
                                      .map(team =>
                                        React.createElement(
                                          "div",
                                          {
                                            key: `${match.id}-team1-club-${team}`,
                                            onClick: () => selectTeam(match.id, "team1Club", team),
                                            className: "p-2 text-white text-sm hover:bg-pink-500 cursor-pointer"
                                          },
                                          team
                                        )
                                      )
                                  ),
                                ]
                              ),
                            ]
                          ),
                          React.createElement(
                            "div",
                            { className: "flex flex-col items-center" },
                            [
                              React.createElement(
                                "div",
                                { className: "flex justify-center items-center" },
                                [
                                  React.createElement("input", {
                                    type: "number",
                                    inputMode: "numeric",
                                    value: match.goals.team1,
                                    onChange: (e) => {
                                      match.goals.team1 = e.target.value;
                                      setMatches([...matches]);
                                    },
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-20 h-12 text-4xl text-center"
                                  }),
                                  React.createElement("div", { className: "text-gray-400 font-bold mx-2 text-lg" }, "vs"),
                                  React.createElement("input", {
                                    type: "number",
                                    inputMode: "numeric",
                                    value: match.goals.team2,
                                    onChange: (e) => {
                                      match.goals.team2 = e.target.value;
                                      setMatches([...matches]);
                                    },
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-20 h-12 text-4xl text-center"
                                  }),
                                ]
                              ),
                              React.createElement(
                                "span",
                                {
                                  onClick: () => handleConfirmMatch(match.id),
                                  className: `mt-2 text-lg cursor-pointer ${match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "text-green-500" : "text-gray-500"}`
                                },
                                match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "✅" : "☑️"
                              ),
                            ]
                          ),
                          React.createElement(
                            "div",
                            { className: "flex-1 min-w-0 max-w-[120px] flex flex-col items-end" },
                            [
                              React.createElement(
                                "span",
                                { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                `${match.team2[0].name} + ${match.team2[1].name}`
                              ),
                              React.createElement(
                                "div",
                                { className: "relative w-full mt-2" },
                                [
                                  React.createElement("input", {
                                    type: "text",
                                    value: teamSearch[`${match.id}-team2Club`] || match.team2Club || "",
                                    onChange: (e) => handleTeamSearch(match.id, "team2Club", e.target.value),
                                    placeholder: "Csapat keresése...",
                                    className: "border border-gray-600 bg-gray-800 text-white p-2 rounded-2xl w-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500"
                                  }),
                                  showSuggestions[`${match.id}-team2Club`] && React.createElement(
                                    "div",
                                    { className: "absolute z-10 bg-gray-800 border border-gray-600 rounded-2xl mt-1 w-full max-h-40 overflow-y-auto" },
                                    teams
                                      .filter(team => team.toLowerCase().includes((teamSearch[`${match.id}-team2Club`] || "").toLowerCase()))
                                      .slice(0, 5)
                                      .map(team =>
                                        React.createElement(
                                          "div",
                                          {
                                            key: `${match.id}-team2-club-${team}`,
                                            onClick: () => selectTeam(match.id, "team2Club", team),
                                            className: "p-2 text-white text-sm hover:bg-pink-500 cursor-pointer"
                                          },
                                          team
                                        )
                                      )
                                  ),
                                ]
                              ),
                            ]
                          ),
                        ]
                      ),
                      match.resting && React.createElement(
                        "p",
                        { className: "text-gray-400 text-sm mt-4 text-center" },
                        `😴 Pihen: ${match.resting.name}`
                      ),
                    ]
                  )
                )
              ),
              matches.length > 0 && React.createElement(
                "button",
                {
                  onClick: handleCloseTournament,
                  className: "mt-8 bg-pink-500 text-white p-3 rounded-2xl w-full hover:bg-pink-400 active:scale-95 transition-all glow"
                },
                "LEZÁRÁS"
              ),
            ]
          ),
        ]
      );
    };

    const Rounds = ({ tournaments, diceGames, players }) => {
      const [viewMode, setViewMode] = useState("fifa");
      const [selectedTournament, setSelectedTournament] = useState(null);
      const [selectedDiceGame, setSelectedDiceGame] = useState(null);

      return React.createElement(
        "div",
        { className: "p-4 max-w-full mx-auto fade-in page-bg" },
        [
          React.createElement(
            "div",
            { className: "bg-gray-900 bg-opacity-85 p-6 rounded-2xl" },
            [
              React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Archív"),
              React.createElement(
                "div",
                { className: "flex gap-4 mt-6" },
                [
                  React.createElement(
                    "button",
                    {
                      onClick: () => setViewMode("fifa"),
                      className: `px-4 py-2 rounded-2xl ${viewMode === "fifa" ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "FIFA Bajnokságok"
                  ),
                  React.createElement(
                    "button",
                    {
                      onClick: () => setViewMode("dice"),
                      className: `px-4 py-2 rounded-2xl ${viewMode === "dice" ? "bg-pink-500 text-white" : "bg-gray-200 text-gray-800"} hover:bg-pink-400 active:scale-95 transition-all glow`
                    },
                    "Kockajátékok"
                  ),
                ]
              ),
              React.createElement(
                "div",
                { className: "mt-6 space-y-4" },
                viewMode === "fifa" ? tournaments.map((tournament, index) =>
                  React.createElement(
                    "div",
                    {
                      key: `tournament-${index}`,
                      className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all cursor-pointer",
                      onClick: () => setSelectedTournament(tournament)
                    },
                    React.createElement("p", { className: "text-gray-400" }, new Date(tournament.timestamp).toLocaleString("hu-HU"))
                  )
                ) : diceGames.map((diceGame, index) =>
                  React.createElement(
                    "div",
                    {
                      key: `dicegame-${index}`,
                      className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500 glow transition-all cursor-pointer",
                      onClick: () => setSelectedDiceGame(diceGame)
                    },
                    React.createElement("p", { className: "text-gray-400" }, new Date(diceGame.timestamp).toLocaleString("hu-HU"))
                  )
                )
              ),
              selectedTournament && React.createElement(
                "div",
                { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4" },
                React.createElement(
                  "div",
                  { className: "bg-gray-900 p-6 rounded-2xl max-h-[80vh] overflow-y-auto w-full max-w-full" },
                  [
                    React.createElement("h3", { className: "text-2xl font-bold text-white" }, `Bajnokság - ${new Date(selectedTournament.timestamp).toLocaleString("hu-HU")}`),
                    React.createElement(
                      "div",
                      { className: "mt-4 space-y-6" },
                      selectedTournament.matches.map((match, index) =>
                        React.createElement(
                          "div",
                          { key: match.id, className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500" },
                          [
                            React.createElement("h4", { className: "text-gray-400 text-sm text-center font-medium" }, `#${index + 1}`),
                            React.createElement(
                              "div",
                              { className: "flex flex-col sm:flex-row justify-between items-center mt-4 space-y-4 sm:space-y-0 sm:space-x-4" },
                              [
                                React.createElement(
                                  "div",
                                  { className: "flex-1 min-w-0 max-w-[120px] flex flex-col items-start" },
                                  [
                                    React.createElement(
                                      "span",
                                      { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                      `${match.team1[0].name} + ${match.team1[1].name}`
                                    ),
                                    React.createElement("p", { className: "text-gray-400 text-sm mt-2" }, match.team1Club || "Nincs csapat"),
                                  ]
                                ),
                                React.createElement(
                                  "div",
                                  { className: "flex flex-col items-center" },
                                  [
                                    React.createElement(
                                      "div",
                                      { className: "flex justify-center items-center" },
                                      [
                                        React.createElement("span", { className: "text-white text-4xl w-20 text-center" }, match.goals.team1 || "-"),
                                        React.createElement("div", { className: "text-gray-400 font-bold mx-2 text-lg" }, "vs"),
                                        React.createElement("span", { className: "text-white text-4xl w-20 text-center" }, match.goals.team2 || "-"),
                                      ]
                                    ),
                                    React.createElement(
                                      "span",
                                      { className: `mt-2 text-lg ${match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "text-green-500" : "text-gray-500"}` },
                                      match.confirmed && match.goals.team1 !== "" && match.goals.team2 !== "" ? "✅" : "☑️"
                                    ),
                                  ]
                                ),
                                React.createElement(
                                  "div",
                                  { className: "flex-1 min-w-0 max-w-[120px] flex flex-col items-end" },
                                  [
                                    React.createElement(
                                      "span",
                                      { className: "text-white font-medium text-sm border border-pink-500 rounded-full px-2 py-1 truncate" },
                                      `${match.team2[0].name} + ${match.team2[1].name}`
                                    ),
                                    React.createElement("p", { className: "text-gray-400 text-sm mt-2" }, match.team2Club || "Nincs csapat"),
                                  ]
                                ),
                              ]
                            ),
                            match.resting && React.createElement(
                              "p",
                              { className: "text-gray-400 text-sm mt-4 text-center" },
                              `😴 Pihen: ${match.resting.name}`
                            ),
                          ]
                        )
                      )
                    ),
                    React.createElement(
                      "button",
                      {
                        onClick: () => setSelectedTournament(null),
                        className: "mt-4 bg-gray-200 text-gray-800 p-3 rounded-2xl w-full hover:bg-gray-100 transition-all"
                      },
                      "Bezárás"
                    ),
                  ]
                )
              ),
              selectedDiceGame && React.createElement(
                "div",
                { className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4" },
                React.createElement(
                  "div",
                  { className: "bg-gray-900 p-6 rounded-2xl max-h-[80vh] overflow-y-auto w-full max-w-full" },
                  [
                    React.createElement("h3", { className: "text-2xl font-bold text-white" }, `Kockajáték - ${new Date(selectedDiceGame.timestamp).toLocaleString("hu-HU")}`),
                    React.createElement(
                      "div",
                      { className: "mt-4 space-y-4" },
                      selectedDiceGame.results.map((result, index) => {
                        const player = players.find(p => p.id === result.playerId);
                        return React.createElement(
                          "div",
                          { key: `result-${index}`, className: "bg-gray-800 bg-opacity-80 p-4 rounded-2xl border border-pink-500" },
                          [
                            React.createElement("span", { className: "text-white font-medium" }, player ? player.name : "Ismeretlen játékos"),
                            React.createElement("span", { className: "text-gray-400 ml-4" }, `${result.position}. helyezett`),
                          ]
                        );
                      })
                    ),
                    React.createElement(
                      "button",
                      {
                        onClick: () => setSelectedDiceGame(null),
                        className: "mt-4 bg-gray-200 text-gray-800 p-3 rounded-2xl w-full hover:bg-gray-100 transition-all"
                      },
                      "Bezárás"
                    ),
                  ]
                )
              ),
            ]
          ),
        ]
      );
    };

    const App = () => {
      const [players, setPlayers] = useState(initialPlayers);
      const [tournaments, setTournaments] = useState([]);
      const [diceGames, setDiceGames] = useState([]);
      const [currentPage, setCurrentPage] = useState("home");

      const addPlayer = (newPlayer) => {
        setPlayers([...players, newPlayer]);
      };

      const addTournament = (tournament) => {
        setTournaments([...tournaments, tournament]);
      };

      const addDiceGame = (diceGame) => {
        setDiceGames([...diceGames, diceGame]);
      };

      useEffect(() => {
        console.log("Setting up hashchange listener");
        const handleHashChange = () => {
          try {
            const hash = window.location.hash.replace("#", "") || "home";
            console.log("Hash changed to:", hash);
            setCurrentPage(hash);
          } catch (error) {
            console.error("Error in handleHashChange:", error);
            setCurrentPage("home");
          }
        };

        handleHashChange();
        window.addEventListener("hashchange", handleHashChange);

        const fetchData = async () => {
          try {
            const tournamentResponse = await fetch('/api/tournaments');
            const diceGameResponse = await fetch('/api/diceGames');
            if (tournamentResponse.ok) {
              const tournamentsData = await tournamentResponse.json();
              setTournaments(tournamentsData);
            }
            if (diceGameResponse.ok) {
              const diceGamesData = await diceGameResponse.json();
              setDiceGames(diceGamesData);
            }
          } catch (error) {
            console.error('Error fetching data:', error);
          }
        };
        fetchData();

        return () => {
          console.log("Removing hashchange listener");
          window.removeEventListener("hashchange", handleHashChange);
        };
      }, []);

      console.log("Rendering App with currentPage:", currentPage);

      return React.createElement(
        "div",
        { className: "min-h-screen bg-gray-900" },
        [
          currentPage === "home" && React.createElement(Home, { tournaments }),
          currentPage === "players" && React.createElement(Players, { players, addPlayer }),
          currentPage === "generate" && React.createElement(GenerateTournament, { players, addTournament }),
          currentPage === "dicegame" && React.createElement(DiceGame, { players, addDiceGame }),
          currentPage === "stats" &&
            React.createElement(
              "div",
              { className: "p-4 max-w-full mx-auto fade-in page-bg" },
              [
                React.createElement(
                  "div",
                  { className: "bg-gray-900 bg-opacity-85 p-6 rounded-2xl" },
                  [
                    React.createElement("h2", { className: "text-3xl font-bold text-white" }, "Statisztika"),
                    React.createElement("p", { className: "text-gray-400 mt-6 font-light" }, "Még fejlesztés alatt!"),
                  ]
                ),
              ]
            ),
          currentPage === "rounds" && React.createElement(Rounds, { tournaments, diceGames, players }),
          React.createElement(NavBar, { setCurrentPage, currentPage }),
        ]
      );
    };

    console.log("Starting render");
    try {
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(React.createElement(App));
      console.log("Render successful");
    } catch (error) {
      console.error("Render error:", error);
    }
  </script>
</body>
</html>
